from google.colab import files
import fitz
import re

# --- Upload file ---
uploaded = files.upload()
filename = list(uploaded.keys())[0]
print(f"✅ Uploaded: {filename}")

# --- Save file ---
with open(filename, "wb") as f:
    f.write(uploaded[filename])

# --- Extract text ---
text = ""
if filename.lower().endswith(".pdf"):
    with fitz.open(filename) as doc:
        for page in doc:
            text += page.get_text("text")

elif filename.lower().endswith(".docx"):
    from docx import Document
    doc = Document(filename)
    text = "\n".join(p.text for p in doc.paragraphs)

elif filename.lower().endswith(".txt"):
    with open(filename, "r", encoding="utf-8", errors="ignore") as f:
        text = f.read()
else:
    raise ValueError("Unsupported file type. Please upload a PDF, DOCX, or TXT file.")

# --- Clean text ---
text = re.sub(r"\s+", " ", text).strip()

# --- Print all text ---
print("\n✅ Full extracted text:\n")
print(text)
